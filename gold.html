<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù†Ù‡Ø§ÛŒÛŒ Ø·Ù„Ø§ÛŒ Û±Û¸ Ø¹ÛŒØ§Ø± â€” Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ (Ø¨Ø§ AutoFetch Ùˆ Alerts)</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root{--bg1:#0f1720;--card:#1f2937;--accent:#ffd369;--muted:#9bd7ff}
*{box-sizing:border-box}
body{margin:0;padding:14px;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,var(--bg1),#0b1116);color:#fff}
.container{max-width:980px;margin:0 auto}
.header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px}
.title{font-size:1.25rem;color:var(--accent);font-weight:700}
.small{font-size:0.85rem;color:#cbd5e1}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;padding:14px;margin-bottom:12px;box-shadow:0 6px 30px rgba(0,0,0,0.6);border:1px solid rgba(255,211,105,0.06)}
.row{display:flex;gap:10px;align-items:center}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
@media(max-width:740px){.grid{grid-template-columns:1fr}}
label{display:block;font-size:0.85rem;margin-bottom:6px;color:#d1d5db}
input[type=number],input[type=text]{width:100%;padding:8px;border-radius:8px;border:none;background:#0b1220;color:#fff}
button{padding:9px 12px;border-radius:10px;border:none;background:var(--accent);color:#000;font-weight:600;cursor:pointer}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff}
.result{background:#071018;padding:10px;border-radius:8px;margin-top:8px;border:1px solid rgba(255,255,255,0.03);font-size:0.95rem}
.kv{display:flex;justify-content:space-between;gap:8px;padding:6px 0;font-size:0.95rem}
.tip{color:var(--muted);font-size:0.88rem;line-height:1.45}
.footer-small{font-size:0.82rem;color:#94a3b8;margin-top:8px}
.toggle{display:inline-block;padding:6px 10px;border-radius:10px;cursor:pointer;font-weight:700}
.toggle.on{background:#16a34a;color:#fff}
.toggle.off{background:#ef4444;color:#fff}
.signals-list{max-height:160px;overflow:auto;margin-top:8px;border-radius:8px;padding:8px;border:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent)}
.signal-item{padding:6px;border-bottom:1px dashed rgba(255,255,255,0.03);font-size:0.9rem}
.canvas-wrap{background:#06121a;padding:8px;border-radius:10px;margin-top:8px}
.legend{display:flex;gap:8px;align-items:center;margin-top:8px}
.legend .dot{width:12px;height:12px;border-radius:3px;display:inline-block}
.entry-dot{background:#16a34a}
.exit-dot{background:#ef4444}
.hr{height:1px;background:rgba(255,255,255,0.03);margin:12px 0;border-radius:2px}
.small-muted{color:#94a3b8;font-size:0.85rem}
.input-inline{display:flex;gap:8px}
.status-badge{display:inline-block;padding:6px 8px;border-radius:8px;font-weight:700}
.status-normal{background:#374151;color:#fff}
.status-high{background:#065f46;color:#fff}
.status-low{background:#7f1d1d;color:#fff}
.counter-box{display:flex;gap:12px;align-items:center}
.counter-box div{min-width:120px}
.btn-active{background:#16a34a;color:#fff}
.btn-inactive{background:#ef4444;color:#fff}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div>
      <div class="title">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù†Ù‡Ø§ÛŒÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ â€” Ø·Ù„Ø§ÛŒ Û±Û¸ Ø¹ÛŒØ§Ø±</div>
      <div class="small">ÙˆØ±Ú˜Ù†: Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ â€” Ø¯Ø³ØªÛŒ + API â€” RSI Ø§Ø² API/ØªØ§Ø±ÛŒØ®Ú†Ù‡</div>
    </div>
    <div class="small-muted">Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­Ù„ÛŒ: LocalStorage â€¢ Ø¯Ø±Ø®ÙˆØ§Ø³Øª API: Ù…Ø­Ø¯ÙˆØ¯ ÛŒØ§ Ù‚Ø§Ø¨Ù„ Ø§ÙØ²Ø§ÛŒØ´</div>
  </div>

  <!-- ØªÙˆØ¶ÛŒØ­Ø§Øª Ùˆ ØªØ§ÛŒÙ… -->
  <div class="card">
    <h3 style="margin:0 0 6px;color:var(--accent)">Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</h3>
    <div class="tip">
      â€¢ Ø±ÙˆØ²Ù‡Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨: Ø¯ÙˆØ´Ù†Ø¨Ù‡ØŒ Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Ùˆ Ø¬Ù…Ø¹Ù‡.<br>
      â€¢ Ø¯Ùˆ Ø¨Ø§Ø²Ù‡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ: 10:30â€“12:00 Ùˆ 18:00â€“22:00.<br>
      â€¢ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø­Ø§Ù„Øª Ø²Ù…Ø§Ù† Ø¢Ø²Ø§Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ ØªØ§ Ù…Ø­Ø¯ÙˆØ¯ÛŒØªÛŒ Ø¯Ø± Ø§Ø¬Ø±Ø§ Ù†Ø¨Ø§Ø´Ø¯.<br>
      â€¢ Ø­Ø¨Ø§Ø¨ Ù‚ÛŒÙ…Øª Ùˆ RSI Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ ÙˆØ±ÙˆØ¯ Ùˆ Ø®Ø±ÙˆØ¬ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.<br>
      â€¢ Ø­Ø¯ Ø¨Ø§Ù„Ø§/Ù¾Ø§ÛŒÛŒÙ† Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯ ØªØ§ Ù‡Ø´Ø¯Ø§Ø± ØµÙˆØªÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯.
    </div>
    <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
      <button id="btnMorning" class="btn-inactive" onclick="setTimeRange('morning')">â° Ø¨Ø§Ø²Ù‡ 10:30â€“12</button>
      <button id="btnEvening" class="btn-inactive" onclick="setTimeRange('evening')">â° Ø¨Ø§Ø²Ù‡ 18â€“22</button>
      <button id="btnFree" class="btn-inactive" onclick="setTimeRange('free')">â° Ø²Ù…Ø§Ù† Ø¢Ø²Ø§Ø¯</button>
    </div>
  </div>

  <!-- ÙˆØ±ÙˆØ¯ÛŒ Ù‡Ø§ Ùˆ API -->
  <div class="card">
    <h3 style="margin:0 0 8px;color:var(--accent)">ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ Ùˆ API</h3>
    <div class="grid">
      <div><label>Ù‚ÛŒÙ…Øª Ø·Ù„Ø§ÛŒ Û±Û¸ Ø¹ÛŒØ§Ø± (ØªÙˆÙ…Ø§Ù†)</label><input id="gold18" type="number" placeholder="Ù…Ø«Ø§Ù„: 12679000"></div>
      <div><label>Ù‚ÛŒÙ…Øª Ø¯Ù„Ø§Ø± (ØªÙˆÙ…Ø§Ù†)</label><input id="usd" type="number" placeholder="Ù…Ø«Ø§Ù„: 125000"></div>
      <div><label>Ù‚ÛŒÙ…Øª Ø§Ù†Ø³ Ø¬Ù‡Ø§Ù†ÛŒ (Ø¯Ù„Ø§Ø±)</label><input id="ounce" type="number" placeholder="Ù…Ø«Ø§Ù„: 1960.12"></div>
      <div><label>Ø§Ø¬Ø±Øª + Ù…Ø§Ù„ÛŒØ§Øª + Ø³ÙˆØ¯ (%)</label><input id="fee" type="number" placeholder="Ù…Ø«Ø§Ù„: 1.2"></div>
    </div>
    <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap;align-items:center">
      <button onclick="addData()">Ø«Ø¨Øª Ø¯Ø§Ø¯Ù‡ (Ø¯Ø³ØªÛŒ)</button>
      <button class="btn-ghost" onclick="fetchBothAPI()">ğŸ“¡ Ø¯Ø±ÛŒØ§ÙØª Ù‡Ù…Ø²Ù…Ø§Ù† Ø§Ø² API</button>
      <button class="btn-ghost" onclick="clearLastData()">ğŸ—‘ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø¢Ø®Ø±ÛŒÙ† Ø¯Ø§Ø¯Ù‡</button>
      <button class="btn-ghost" onclick="clearAllData()">ğŸ—‘ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</button>
      <div style="flex:1"></div>
      <div style="min-width:220px">
        <label>API Ú©Ù„ÛŒØ¯ Ø¨Ø±Ø§ÛŒ RSI (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
        <div class="input-inline"><input id="rsiApiKey" type="text" placeholder="Ù…Ø«Ø§Ù„: ALPHAVANTAGE_KEY"><button class="btn-ghost" onclick="saveRSIKey()">Ø°Ø®ÛŒØ±Ù‡</button></div>
        <div class="small-muted" style="margin-top:6px">Ø§Ú¯Ø± ÙˆØ§Ø±Ø¯ Ù†Ø´ÙˆØ¯ØŒ RSI Ø§Ø² ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</div>
      </div>
    </div>
  </div>

  <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª AutoFetch Ùˆ Ù‡Ø´Ø¯Ø§Ø± -->
  <div class="card">
    <h3 style="margin:0 0 8px;color:var(--accent)">ØªÙ†Ø¸ÛŒÙ…Ø§Øª AutoFetch Ùˆ Ù‡Ø´Ø¯Ø§Ø±</h3>
    <div class="grid">
      <div><label>Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ú©Ù„ Ø¯Ø± Ø¨Ø§Ø²Ù‡</label><input id="maxRequests" type="number" value="100" min="1" max="1500"></div>
      <div><label>Ø§Ø¬Ø±Ø§ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</label><div style="display:flex;gap:8px"><button onclick="startAutoFetch()">â–¶ Ø´Ø±ÙˆØ¹</button><button class="btn-ghost" onclick="stopAutoFetch()">â–  ØªÙˆÙ‚Ù</button></div></div>
      <div><label>Ø­Ø¯ Ù¾Ø§ÛŒÛŒÙ† Ù‡Ø´Ø¯Ø§Ø± (ØªÙˆÙ…Ø§Ù†)</label><input id="lowLimit" type="number" placeholder="Ù…Ø«Ø§Ù„: 12000000"></div>
      <div><label>Ø­Ø¯ Ø¨Ø§Ù„Ø§ Ù‡Ø´Ø¯Ø§Ø± (ØªÙˆÙ…Ø§Ù†)</label><input id="highLimit" type="number" placeholder="Ù…Ø«Ø§Ù„: 18000000"></div>
    </div>
    <div class="hr"></div>
    <div class="counter-box">
      <div>Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡: <strong id="doneCount">0</strong></div>
      <div>Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡: <strong id="leftCount">0</strong></div>
      <div>Ø¨Ø¹Ø¯ÛŒ Ø¯Ø±: <strong id="nextIn">â€”</strong> Ø«Ø§Ù†ÛŒÙ‡</div>
    </div>
  </div>

  <!-- Ù†Ù…ÙˆØ¯Ø§Ø± Ùˆ Ø³ÛŒÚ¯Ù†Ø§Ù„ -->
  <div class="card">
    <h3 style="margin:0 0 8px;color:var(--accent)">Ù†Ù…ÙˆØ¯Ø§Ø± Ø­Ø¨Ø§Ø¨ØŒ Ø­Ù…Ø§ÛŒØª/Ù…Ù‚Ø§ÙˆÙ…Øª Ùˆ RSI</h3>
    <div class="canvas-wrap">
      <canvas id="trendChart" style="width:100%;height:360px"></canvas>
    </div>
    <div class="legend">
      <div class="dot entry-dot"></div><div class="small-muted">Ù†Ù‚Ø·Ù‡ ÙˆØ±ÙˆØ¯</div>
      <div class="dot exit-dot" style="margin-left:8px"></div><div class="small-muted">Ù†Ù‚Ø·Ù‡ Ø®Ø±ÙˆØ¬</div>
    </div>
    <div class="hr"></div>
    <div class="result" id="goldResult">ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù…Ø§Ø¯Ù‡</div>
    <div class="signals-list" id="signalsList"></div>
  </div>
</div>
<script>
// Ø§ÛŒÙ† Ù‚Ø³Ù…Øª Ø´Ø§Ù…Ù„ Ú©Ù„ JS ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù‡Ù…Ø²Ù…Ø§Ù† APIØŒ RSIØŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø­Ø¨Ø§Ø¨ Ùˆ Ù†Ù…ÙˆØ¯Ø§Ø± Ø§Ø³Øª
// + AutoFetch Ø¨Ø§ Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¯Ù‚ÛŒÙ‚ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ø«Ø§Ù†ÛŒÙ‡/Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡
// Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø§Ø²Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ùˆ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
// Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ø·ÙˆÙ„ Ø²ÛŒØ§Ø¯ØŒ Ø¯Ø± Ø§ÛŒÙ† Ù¾Ø§Ø³Ø® JS Ú©Ø§Ù…Ù„ Ù†ÙˆØ´ØªÙ‡ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ø§Ù…Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ø¯Ø± Ø§Ø¯Ø§Ù…Ù‡ JS Ú©Ø§Ù…Ù„ Ùˆ Ø¹Ù…Ù„ÛŒ Ø¨Ø±Ø§ÛŒ AutoFetch Ùˆ Ù†Ù…ÙˆØ¯Ø§Ø± Ùˆ Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§ Ø¨Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‚ÛŒÙ‚ Ø«Ø§Ù†ÛŒÙ‡/Ø¯Ù‚ÛŒÙ‚Ù‡ Ùˆ Ù‡Ø´Ø¯Ø§Ø± ØµÙˆØªÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ù†Ù….
</script>
</body>
</html>
