<div class="signal-box" id="signalBox">
    ğŸ“¡ Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ Ù†ÙˆØ³Ø§Ù†â€¦
</div>

<canvas id="trendChart" style="margin-top:20px; width:100%; height:150px;"></canvas>

<style>
.signal-box {
    margin-top:20px; 
    padding:20px; 
    background: linear-gradient(145deg, #eef4ff, #d6e0ff);
    border-right:6px solid #4d7bff; 
    border-radius:12px; 
    font-size:18px;
    font-family: Arial, sans-serif;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    transition: all 0.4s ease;
    text-align: center;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('trendChart').getContext('2d');
let trendChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [],
        datasets: [{
            label: 'Ø­Ø¨Ø§Ø¨ Ù‚ÛŒÙ…Øª',
            data: [],
            borderColor: '#4d7bff',
            backgroundColor: 'rgba(77,123,255,0.2)',
            tension: 0.3,
            fill: true
        }]
    },
    options: {
        responsive: true,
        scales: { y: { beginAtZero: false } }
    }
});

function updateSignal(bubbleHistory) {
    let box = document.getElementById("signalBox");

    if (bubbleHistory.length < 3) {
        box.innerHTML = "ğŸ“¡ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø¯Ø§Ø¯Ù‡ Ø¨ÛŒØ´ØªØ± Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù†ÙˆØ³Ø§Ù†â€¦";
        box.style.borderRightColor = "#4d7bff";
        return;
    }

    let last = bubbleHistory[bubbleHistory.length - 1];
    let prev = bubbleHistory[bubbleHistory.length - 2];
    let before = bubbleHistory[bubbleHistory.length - 3];

    let upTrend = last > prev && prev > before;
    let downTrend = last < prev && prev < before;

    if (last < -20000 && upTrend) {
        box.innerHTML = "ğŸŸ¢ <b>Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø®Ø±ÛŒØ¯</b><br>Ø­Ø¨Ø§Ø¨ Ù…Ù†ÙÛŒ Ùˆ Ø±ÙˆÙ†Ø¯ ØµØ¹ÙˆØ¯ÛŒ";
        box.style.borderRightColor = "green";
    } else if (last > 20000 && downTrend) {
        box.innerHTML = "ğŸ”´ <b>Ø³ÛŒÚ¯Ù†Ø§Ù„ ÙØ±ÙˆØ´</b><br>Ø­Ø¨Ø§Ø¨ Ù…Ø«Ø¨Øª Ùˆ Ø±ÙˆÙ†Ø¯ Ù†Ø²ÙˆÙ„ÛŒ";
        box.style.borderRightColor = "red";
    } else if (Math.abs(last) < 15000) {
        box.innerHTML = "âš– <b>Ù…Ù†Ø·Ù‚Ù‡ Ø®Ù†Ø«ÛŒ</b><br>Ù…Ø¹Ø§Ù…Ù„Ù‡ Ù†Ú©Ù†ØŒ Ø¨Ø§Ø²Ø§Ø± Ù†Ø§Ù…Ø´Ø®Øµ";
        box.style.borderRightColor = "#bbb";
    } else {
        box.innerHTML = "ğŸ“¡ <b>Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒâ€¦</b>";
        box.style.borderRightColor = "#4d7bff";
    }

    // Ù†Ù…ÙˆØ¯Ø§Ø± Ø±Ø§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ù†
    trendChart.data.labels = bubbleHistory.map((_, i) => i+1);
    trendChart.data.datasets[0].data = bubbleHistory;
    trendChart.update();
}
</script>
